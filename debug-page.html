<!DOCTYPE html>
<html>
<head>
    <title>FleetLink Debug Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; }
        .log { background: #f5f5f5; padding: 10px; margin: 10px 0; font-family: monospace; }
        button { padding: 10px 20px; margin: 5px; }
    </style>
</head>
<body>
    <h1>ğŸ” FleetLink Debug Test</h1>
    
    <div class="section">
        <h2>ğŸ—ºï¸ MapBox API Tests</h2>
        <button onclick="testGeocoding()">Test Geocoding</button>
        <button onclick="testDirections()">Test Directions</button>
        <div id="api-results" class="log"></div>
    </div>

    <div class="section">
        <h2>ğŸ“± Application Tests</h2>
        <p>Instructions:</p>
        <ol>
            <li>Open the main application in another tab: <a href="http://localhost:8081" target="_blank">FleetLink App</a></li>
            <li>Open browser console (F12) and watch for debug messages</li>
            <li>Try adding a vehicle with location search</li>
            <li>Try generating a route for a vehicle</li>
        </ol>
        
        <h3>Expected Debug Messages:</h3>
        <div class="log">
ğŸ¯ LocationFinder: Suggestion selected: {...}
ğŸ“ LocationFinder: Calling onLocationSelect with: {...}
ğŸš› AddVehicleTab: Location selected: {...}
ğŸš› AddVehicleTab: Updated newVehicle: {...}
ğŸš› AddVehicleTab: handleAddVehicle called with: {...}
âœ… [LOCAL] Vehicle added: VEHICLE-ID
ğŸ”µ Route button clicked for vehicle: VEHICLE-ID
ğŸ¯ generateRouteForVehicle called with vehicle: {...}
ğŸš€ Generating route for vehicle VEHICLE-ID
        </div>
    </div>

    <script>
        const MAPBOX_TOKEN = 'pk.eyJ1IjoibW5pZmFpIiwiYSI6ImNtZjM5dng3dzAxZWYybHEwdmZ2MmE4MDkifQ.CGxxP82dHH4tu6V9D6FhHg';
        
        function log(message) {
            const div = document.getElementById('api-results');
            div.innerHTML += new Date().toLocaleTimeString() + ': ' + message + '<br>';
        }
        
        async function testGeocoding() {
            log('ğŸŒ Testing MapBox Geocoding API...');
            try {
                const query = 'Times Square New York';
                const url = `https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(query)}.json?access_token=${MAPBOX_TOKEN}&limit=5&types=place,locality,neighborhood,address`;
                
                const response = await fetch(url);
                const data = await response.json();
                
                log(`âœ… Geocoding Success: Found ${data.features?.length || 0} results`);
                if (data.features && data.features.length > 0) {
                    log(`ğŸ“ First result: ${data.features[0].place_name}`);
                    log(`ğŸ“ Coordinates: [${data.features[0].center[1]}, ${data.features[0].center[0]}]`);
                }
            } catch (error) {
                log(`âŒ Geocoding Error: ${error.message}`);
            }
        }
        
        async function testDirections() {
            log('ğŸ›£ï¸ Testing MapBox Directions API...');
            try {
                const start = '-73.9857,40.7484'; // Times Square
                const end = '-73.9442,40.8176';   // Columbia University
                const url = `https://api.mapbox.com/directions/v5/mapbox/driving/${start};${end}?access_token=${MAPBOX_TOKEN}&overview=full&geometries=geojson`;
                
                const response = await fetch(url);
                const data = await response.json();
                
                log(`âœ… Directions Success: Found ${data.routes?.length || 0} routes`);
                if (data.routes && data.routes.length > 0) {
                    log(`ğŸ›£ï¸ Distance: ${(data.routes[0].distance / 1000).toFixed(2)} km`);
                    log(`â±ï¸ Duration: ${Math.round(data.routes[0].duration / 60)} minutes`);
                    log(`ğŸ—ºï¸ Has geometry: ${!!data.routes[0].geometry}`);
                }
            } catch (error) {
                log(`âŒ Directions Error: ${error.message}`);
            }
        }
    </script>
</body>
</html>